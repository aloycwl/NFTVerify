<!DOCTYPE html>
<html>
  <head>
    <title>The Wooing Club (TWC)</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <style>
      button {
        font-weight: bold;
        height: 100px;
        width: 100%;
      }
    </style>

    <script src="https://aloycwl.github.io/js/cdn/web3.min.js"></script>
    <script defer src="https://aloycwl.github.io/js/cdn/moment.min.js"></script>
  </head>
  <body>
    <h1>Member of:</h1>
    <button
      onclick="load('0xD120D29947BCb41812Dc6e7AbA2782E7c8237F36',this.innerHTML)"
    >
      The Woobeing Club (TWC)</button
    ><br /><br />
    <button
      onclick="load('0x72E4c656a7121370d5A26d9b72eAC140F3A37469',this.innerHTML)"
    >
      The Wellbeing Group (TWG)
    </button>
    <script>
      async function load(p1, p2) {
        acct = await ethereum.request({ method: 'eth_requestAccounts' });
        web3 = new Web3(ethereum);
        contract = new web3.eth.Contract(
          [
            {
              constant: true,
              inputs: [{ name: '', type: 'address' }],
              name: 'balanceOf',
              outputs: [{ name: '', type: 'uint256' }],
              type: 'function',
            },
          ],
          p1
        );
        count = await contract.methods.balanceOf(acct[0]).call();

        document.write(
          (count > 0
            ? `${
                acct[0]
              } is a member of <b>${p2}</b><br><br>Access granted on<br><br>${moment().format(
                'dddd h:mma D MMM YY'
              )}`
            : `You do not have any token with us.`) +
            `<br><br><a href="#" onclick="location.reload()">back</a>`
        );
      }
    </script>
  </body>
</html>
